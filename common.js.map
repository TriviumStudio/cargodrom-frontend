{"version":3,"file":"common.js","mappings":"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","sources":["./src/app/pages/services/mySetting.service.ts","./src/app/shared/classes/base-component.ts","./src/app/shared/classes/editor.ts","./src/app/shared/constants/index.ts","./src/app/shared/constants/sort-predicate.ts","./src/app/shared/constants/transport-sub-kind-table.ts","./src/app/shared/constants/unknown-country.ts"],"sourcesContent":["import { Component, Injectable } from '@angular/core';\nimport { SettingsService as ApiSettingsService } from 'src/app/api/services';\nimport { takeUntil, tap } from 'rxjs/operators';\nimport { AddPopupComponent } from '../modules/settings/components/popap-table_filter-editor/popap-table_filter-editor.component';\nimport { ActivatedRoute } from '@angular/router';\nimport { BehaviorSubject, Subject } from 'rxjs';\n\n/**\n * Сервис для работы с меню настроек приложения\n * Предоставляет методы для загрузки и управления структурой меню настроек\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class MySettingsService {\n  private _menuGroups: MenuGroup[] = [];\n  private _tableRows$ = new BehaviorSubject<any[]>([]); // Subject для хранения и передачи строк таблицы\n  private _destroy$ = new Subject<void>(); // Subject для отписки\n\n  constructor(\n    private apiSettingsService: ApiSettingsService,\n    private route: ActivatedRoute\n  ) {}\n\n  /**\n   * Возвращает текущие группы меню настроек\n   * @returns Массив групп меню с их элементами\n   */\n  getMenuGroups(): MenuGroup[] {\n    return this._menuGroups;\n  }\n\n  /**\n   * Загружает данные для меню настроек с сервера и инициализирует структуру меню\n   * @returns Observable, который завершается после успешной загрузки и инициализации меню\n   */\n  loadMenuGroups() {\n    return this.apiSettingsService.settingsFilterFormParam().pipe(\n      tap(response => {\n        this._menuGroups = this.buildMenuGroups(response.tables);\n      })\n    );\n  }\n\n  /**\n   * Создает полную структуру меню настроек на основе данных с сервера\n   * @param tables Массив таблиц, полученных с сервера, для раздела \"Фильтры на формах\"\n   * @returns Полная структура меню настроек с статичными и динамическими разделами\n   */\n  private buildMenuGroups(tables: any[]): MenuGroup[] {\n    return [\n      this.createCommonSettingsGroup(),\n      this.createCompanyStructureGroup(),\n      this.createSystemGroup(),\n      this.createTableFiltersGroup(tables),\n      this.createDirectoriesGroup()\n    ];\n  }\n\n  /**\n   * Создает группу \"Общие настройки\"\n   * @returns Группа меню с общими настройками приложения\n   */\n  private createCommonSettingsGroup(): MenuGroup {\n    return {\n      title: 'Общие настройки',\n      cssClass: 'settings-common',\n      expanded: false,\n      items: [\n        {\n          title: 'Личные настройки',\n          link: './personal'\n        },\n        {\n          title: 'Организации',\n          link: './company',\n          canAdd: true,\n          addButtonTitle: 'Добавить организацию'\n        }\n      ]\n    };\n  }\n\n  /**\n   * Создает группу \"Структура организации\"\n   * @returns Группа меню с элементами структуры организации\n   */\n  private createCompanyStructureGroup(): MenuGroup {\n    return {\n      title: 'Структура организации',\n      cssClass: 'settings-company-structure',\n      expanded: false,\n      items: [\n        {\n          title: 'Подразделения',\n          link: './department',\n          canAdd: true,\n          addButtonTitle: 'Добавить подразделение'\n        },\n        {\n          title: 'Должности',\n          link: './position',\n          canAdd: true,\n          addButtonTitle: 'Добавить должность'\n        },\n        {\n          title: 'Сотрудники',\n          link: './employee',\n          canAdd: true,\n          addButtonTitle: 'Добавить сотрудника'\n        }\n      ]\n    };\n  }\n\n  /**\n   * Создает группу \"Система\"\n   * @returns Группа меню с элементами системы\n   */\n  private createSystemGroup(): MenuGroup {\n    return {\n      title: 'Система',\n      cssClass: 'settings-system',\n      expanded: false,\n      items: [\n        {\n          title: 'Общие настройки',\n          link: './general-settings',\n          canAdd: false,\n          // addButtonTitle: 'Добавить подразделение'\n        },\n        {\n          title: 'Брендирование',\n          link: './branding',\n          canAdd: false,\n        },\n        {\n          title: 'Уведомления',\n          link: './notifications',\n          canAdd: false,\n          // addButtonTitle: 'Добавить сотрудника'\n        },\n        // {\n        //   title: 'Рассылки',\n        //   link: './mailings',\n        //   canAdd: false,\n        //   // addButtonTitle: 'Добавить сотрудника'\n        // }\n      ]\n    };\n  }\n\n  /**\n   * Создает группу \"Фильтры на формах\" с динамическими элементами из API\n   * @param tables Массив таблиц для преобразования в элементы меню\n   * @returns Группа меню с фильтрами таблиц\n   */\n  private createTableFiltersGroup(tables: any[]): MenuGroup {\n    return {\n      title: 'Фильтры на формах',\n      cssClass: 'settings-table-filter',\n      expanded: false,\n      items: this.transformTablesToMenuItems(tables)\n    };\n  }\n\n  /**\n   * Создает группу \"Справочники\"\n   * @returns Группа меню со справочниками системы\n   */\n  private createDirectoriesGroup(): MenuGroup {\n    return {\n      title: 'Справочники',\n      cssClass: 'settings-directory',\n      expanded: false,\n      items: [\n        {\n          title: 'Группы клиентов',\n          link: './client-group',\n          canAdd: true,\n          addButtonTitle: 'Добавить группу'\n        }\n      ]\n    };\n  }\n\n  /**\n   * Преобразует массив таблиц из API в элементы меню\n   * Обрабатывает формирование корректных URL и названий для множественного числа\n   * @param tables Массив таблиц для преобразования\n   * @returns Массив элементов меню для раздела фильтров таблиц\n   */\n  private transformTablesToMenuItems(tables: any[]): MenuItem[] {\n    return tables.map(table => {\n      // Формируем URL в множественном числе с обработкой исключений\n      const pluralId = table.id;\n      \n      return {\n        title: table.name,\n        link: `./table-filter/${pluralId}`,\n        canAdd: false,\n        // addButtonTitle: 'Добавить новый фильтр',\n        // addPopap: true,\n        // popap: AddPopupComponent,\n      };\n    });\n  }\n\n  // /**\n  //  * Преобразует идентификатор таблицы в форму множественного числа\n  //  * @param tableId Идентификатор таблицы в единственном числе\n  //  * @returns Идентификатор таблицы во множественном числе\n  //  */\n  // private getPluralTableId(tableId: string): string {\n  //   // Обработка специальных случаев\n  //   if (tableId === 'customer') {\n  //     return 'customers';\n  //   }\n    \n  //   // Стандартное правило - добавление 's' в конец\n  //   if (!tableId.endsWith('s')) {\n  //     return tableId + 's';\n  //   }\n    \n  //   return tableId;\n  // }\n\n  /**\n   * Загружает строки таблицы и обновляет BehaviorSubject\n   * @param tableName Название таблицы для загрузки\n   */\n  loadTableRows(tableName: string) {\n    this.apiSettingsService.settingsFilterList({ table: tableName }).pipe(\n      takeUntil(this._destroy$)\n    ).subscribe(rows => {\n      if (rows.items != undefined) {\n        this._tableRows$.next(rows.items);\n      }\n    });\n  }\n  \n\n  /**\n   * Возвращает Observable для подписки на изменения строк таблицы\n   * @returns Observable с массивом строк таблицы\n   */\n  getTableRows$() {\n    return this._tableRows$.asObservable();\n  }\n\n  /**\n   * Обновляет данные в BehaviorSubject вручную\n   * @param rows Новые данные для таблицы\n   */\n  updateTableRows(rows: any[]) {\n    this._tableRows$.next(rows);\n  }\n\n  /**\n   * Очищает ресурсы при уничтожении сервиса\n   */\n  ngOnDestroy() {\n    this._destroy$.next();\n    this._destroy$.complete();\n    this._tableRows$.complete();\n  }\n}\n\n/**\n * Интерфейс группы меню настроек\n */\ninterface MenuGroup {\n  title: string;\n  cssClass: string;\n  expanded: boolean;\n  items: MenuItem[];\n}\n\n/**\n * Интерфейс элемента меню настроек\n */\ninterface MenuItem {\n  title: string;\n  link: string;\n  canAdd?: boolean;\n  addPopap?: boolean;\n  addButtonTitle?: string;\n  popap?: any\n}\n","// base-component.ts\nimport { Directive, OnDestroy } from '@angular/core';\nimport { MatSnackBarConfig } from '@angular/material/snack-bar';\nimport { Subject } from 'rxjs';\n\n@Directive()\nexport abstract class BaseComponent implements OnDestroy {\n  protected destroy$ = new Subject<void>();\n\n  snackBarWithShortDuration: MatSnackBarConfig = { duration: 2000 };\n  snackBarWithLongDuration: MatSnackBarConfig = { duration: 4000 };\n  \n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}","import { byField } from '../constants/sort-predicate';\nimport { Directive, OnInit } from '@angular/core';\nimport { Observable, of, switchMap, tap } from 'rxjs';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { FormControl, FormGroup } from \"@angular/forms\";\nimport { MatSnackBar, MatSnackBarConfig } from \"@angular/material/snack-bar\";\nimport { BusinessKind, ClientKind, ClientStatus, ContactSource, Currency, HeadPosition, InteractionKind, ServiceKind, TaxSystem } from \"src/app/api/custom_models\";\nimport { Location } from '@angular/common';\nimport { SystemService } from 'src/app/api/services';\n\n@Directive()\nexport abstract class Editor<T> implements OnInit {\n  isNavigateAfterSave:boolean=true;\n\n  id?: number;\n  form!: FormGroup;\n  isEditMode = false;\n  snackBarWithShortDuration: MatSnackBarConfig = { duration: 1000 };\n  snackBarWithLongDuration: MatSnackBarConfig = { duration: 5000 };\n  taxSystems: TaxSystem[] = [];\n  currencies: Currency[] = [];\n  headPositions: HeadPosition[] = [];\n  businessKinds: BusinessKind[] = []; filteredBusinessKinds: BusinessKind[] = [];\n  interactionKinds: InteractionKind[] = [];\n  contactSources: ContactSource[] = []; filteredContactSources: ContactSource[] = [];\n  clientStatuses: ClientStatus[] = []; filteredClientStatuses: ClientStatus[] = [];\n  clientKinds: ClientKind[] = []; filteredClientKinds: ClientKind[] = [];\n  serviceKinds: ServiceKind[] = [];\n  isFormSubmitted = false;\n  data: Partial<T> = {};\n  abstract editTitle: string;\n  abstract newTitle: string;\n  abstract savedMessage: string;\n  abstract removedMessage: string;\n  abstract createdMessage: string;\n  abstract notFoundMessage: string;\n  nameForHeader?: string;\n\n  private currentTitle = '';\n\n  protected abstract create(params: { body: Omit<T, 'id'> }): Observable<{id: number}>;\n  protected abstract read(params: { id: number }): Observable<T>;\n  protected abstract update(params: { body: Partial<T> }): Observable<void>;\n  protected abstract delete(params: { body: { id: number } }): Observable<void>;\n\n  protected abstract getNameForHeader(body: T): string;\n\n  constructor(\n    protected location: Location,\n    protected systemService: SystemService,\n    protected route: ActivatedRoute,\n    protected snackBar: MatSnackBar,\n    protected router: Router,\n  ) { }\n\n  ngOnInit(): void {\n    this.detectEditMode();\n    if (this.isEditMode) {\n      this.id = this.getIdParam();\n      this.load();\n    }\n    this.currentTitle = this.isEditMode ? this.editTitle : this.newTitle;\n  }\n\n  get title(): string {\n    return this.currentTitle;\n  }\n\n  goBack(): void {\n    this.location.back();\n  }\n\n  loadTaxSystems(): void {\n    this.systemService.systemTaxSystem().subscribe(\n      taxSystems => this.taxSystems = taxSystems ? (taxSystems as TaxSystem[]).sort(byField('name', 'asc', 'case-insensitive')) : []\n    );\n  }\n\n  loadCurrencies(): void {\n    this.systemService.systemCurrency().subscribe(\n      currencies => this.currencies = currencies.current ? (currencies.current as Currency[]).sort(byField('code', 'asc', 'case-insensitive')) : []\n    );\n    console.log(this.currencies);\n\n  }\n\n  loadHeadPositions(): void {\n    this.systemService.systemHeadPosition().subscribe(\n      positions => this.headPositions = positions ? (positions as HeadPosition[]).sort(byField('name', 'asc', 'case-insensitive')) : []\n    );\n  }\n\n  loadBusinessKinds(): void {\n    this.systemService.systemBusiness().subscribe(\n      kinds => {\n        this.filteredBusinessKinds = kinds ? (kinds as BusinessKind[]).sort(byField('num', 'asc', 'numeric')) : [];\n        this.businessKinds = kinds ? (kinds as BusinessKind[]).sort(byField('num', 'asc', 'numeric')) : [];\n      }\n    );\n  }\n\n  loadInteractionKinds(): void {\n    this.systemService.systemInteraction().subscribe(\n      kinds => this.interactionKinds = kinds ? (kinds as InteractionKind[]).sort(byField('num', 'asc', 'numeric')) : []\n    );\n  }\n\n  loadContactSources(): void {\n    this.systemService.systemContactSource().subscribe(\n      kinds => {\n        this.filteredContactSources = kinds ? (kinds as ContactSource[]).sort(byField('name', 'asc', 'case-insensitive')) : [];\n        this.contactSources = kinds ? (kinds as ContactSource[]).sort(byField('name', 'asc', 'case-insensitive')) : [];\n      }\n    );\n  }\n\n  loadClientStatuses(): void {\n    this.systemService.systemCustomerStatus().subscribe(\n      kinds => {\n        this.filteredClientStatuses = kinds ? (kinds as ClientStatus[]).sort(byField('name', 'asc', 'case-insensitive')) : [];\n        this.clientStatuses = kinds ? (kinds as ClientStatus[]).sort(byField('name', 'asc', 'case-insensitive')) : [];\n      }\n    );\n  }\n\n  loadClientKinds(): void {\n    this.systemService.systemCounterparty().subscribe(\n      kinds => {\n        this.clientKinds = kinds ? (kinds as ClientKind[]).sort(byField('num', 'asc', 'numeric')) : [];\n        this.filteredClientKinds = kinds ? (kinds as ClientKind[]).sort(byField('num', 'asc', 'numeric')) : [];\n      }\n    );\n  }\n\n  loadServiceKinds(): void {\n    this.systemService.systemServices().subscribe(\n      kinds => this.serviceKinds = kinds ? (kinds as ServiceKind[]).sort(byField('name', 'asc', 'case-insensitive')) : []\n    );\n  }\n\n  hasError(controlName: string): boolean {\n    const control = this.form.get(controlName) as FormControl;\n    return control.invalid;\n  }\n\n  getError(controlName: string): string {\n    const control = this.form.get(controlName) as FormControl;\n    if (control.errors?.['required']) {\n      return 'Поле обязательно';\n    }\n    if (control.errors?.['email']) {\n      return 'Невалидный email';\n    }\n    if (control.errors?.['inn']) {\n      return 'Неверный формат ИНН';\n    }\n    if (control.errors?.['mask']) {\n      return 'Неверный формат';\n    }\n    return '';\n  }\n\n\n  showMessage(message: string): void {\n    this.snackBar.open(message, undefined, this.snackBarWithShortDuration);\n  }\n\n  showMessageAndGoBack(message: string): void {\n    this.showMessage(message);\n    this.goBack();\n  }\n\n  showMessageAndSwitchToEditMode(message: string, id: number): void {\n    this.showMessage(message);\n    this.router.navigate(['..', id], {replaceUrl: true, relativeTo: this.route});\n  }\n\n  showMessageAndReload(message: string): void {\n    this.showMessage(message);\n    this.load();\n  }\n\n  showError(message: string, err?: any): void {\n    if (typeof err?.error?.error_message === 'string') {\n      const hasDescription = typeof err.error?.error_message_description === 'string';\n      if (hasDescription) {\n        this.snackBar.open(`${message}: ` + err.error?.error_message + ':' + err.error?.error_message_description, undefined, this.snackBarWithLongDuration);\n      } else {\n        this.snackBar.open(`${message}: ` + err.error?.error_message, undefined, this.snackBarWithLongDuration);\n      }\n    } else {\n      this.snackBar.open(message, undefined, this.snackBarWithLongDuration);\n    }\n  }\n\n  showErrorAndGoBack(err: any, message: string): void {\n    this.showError(message, err);\n    this.goBack();\n  }\n\n  load(): void {\n    const id = this.getIdParam();\n    this.read({ id })\n      .pipe(tap(data => {\n        // currently, when entity doesn't exist the service returns HTTP 200 with empty response body instead of HTTP 404\n        // therefore we have to handle that case manually\n        if (!data) {\n          throw ({ error: { error_message: `запись не существует` } });\n        }\n      }))\n      .subscribe({\n        next: data => {\n          console.log(data);\n\n          this.data = data as T;\n          this.patchForm();\n\n          this.nameForHeader = this.getNameForHeader(data as T);\n        },\n        error: (err: any) => this.showErrorAndGoBack(err, this.notFoundMessage)\n      });\n  }\n\n  patchForm(){\n    console.log('patchForm');\n\n    this.form.patchValue(this.data);\n  }\n\n  save(): void {\n    this.isFormSubmitted = true;\n    if (!this.form.valid) {\n      this.showError('Не все поля заполнены корректно');\n      return;\n    }\n    const body = this.form.value;\n    if (typeof (this.data as any).id === 'number') {\n      this.updateData(body);\n    } else {\n      this.createData(body);\n    }\n  }\n\n  remove(): void {\n    const body = { id: (this.data as any).id as number };\n    this.delete({ body })\n      .pipe(switchMap(() => this.afterDelete()))\n      .subscribe({\n        next: () => this.showMessageAndGoBack(this.removedMessage),\n        error: (err) => this.showError('Ошибка', err)\n      });\n  }\n\n  protected afterCreate(body: {id: number}): Observable<{id: number}> {\n    return of ({id: body.id});\n  }\n\n  protected afterUpdate(): Observable<void> {\n    return of (undefined);\n  }\n\n  protected afterDelete(): Observable<void> {\n    return of(undefined);\n  }\n\n  private createData(body: any) {\n    this.create({ body })\n      .pipe(switchMap(body => this.afterCreate(body)))\n      .subscribe({\n        next: ({ id }) => {\n          // this.showMessageAndSwitchToEditMode(this.createdMessage, id)\n          if(this.isNavigateAfterSave){\n            this.showMessageAndGoBack(this.removedMessage)\n          } else {\n            this.showMessageAndSwitchToEditMode(this.createdMessage, id)\n          }\n        },\n        error: (err) => this.showError(`Ошибка`, err)\n      });\n  }\n\n  private updateData(body: any) {\n    this.update({ body })\n    .pipe(switchMap(() => this.afterUpdate()))\n    .subscribe({\n      next: () => {\n        if(this.isNavigateAfterSave){\n          this.showMessageAndGoBack(this.removedMessage)\n        } else {\n          this.showMessageAndReload(this.savedMessage)\n        }\n      },\n      error: (err) => this.showError(`Ошибка`, err)\n    });\n  }\n\n  private detectEditMode(): void {\n    const segments = this.route.snapshot.url.map(s => s.path);\n    this.isEditMode = segments[0] !== 'add';\n  }\n\n  private getIdParam(): number {\n    return Number(this.route.snapshot.paramMap.get('id'));\n  }\n}\n","export * from './sort-predicate';\nexport * from './transport-sub-kind-table';\nexport * from './unknown-country';","export type SortOrder = 'asc' | 'desc';\nexport type SortType = 'numeric' | 'case-sensitive' | 'case-insensitive';\n\nexport const byName = (order: SortOrder) => (a: { name: string }, b: { name: string }) => {\n  const aName = a.name.toLocaleLowerCase();\n  const bName = b.name.toLocaleLowerCase();\n  const result = aName.localeCompare(bName);\n  return order === 'asc' ? result : -result;\n}\n\nexport const byField = <T>(field: keyof T, order: SortOrder, type: SortType) => (a: T, b: T) => {\n  let result = 0;\n  if (type === 'numeric') {\n    const aField = a[field] as unknown as number;\n    const bField = b[field] as unknown as number;\n    result = aField - bField;\n  } else if (type === 'case-insensitive') {\n    const aField = (a[field] as unknown as string).toLocaleLowerCase();\n    const bField = (b[field] as unknown as string).toLocaleLowerCase();\n    result = aField.localeCompare(bField);\n  } else if (type === 'case-sensitive') {\n    const aField = (a[field] as unknown as string);\n    const bField = (b[field] as unknown as string);\n    result = aField.localeCompare(bField);\n  }\n  return order === 'asc' ? result : -result;\n}\n","import { TransportSubKind } from \"src/app/api/custom_models/transport\";\n\nexport const transportSubKindTable: {\n  kind: TransportSubKind,\n  type: 'air' | 'road' | 'sea' | 'rail',\n  classes: string[];\n  name: string;\n}[] = [\n    { kind: 'avia_lcl', type: 'air', classes: ['s'], name: 'LCL' },\n    { kind: 'avia_fcl', type: 'air', classes: ['e'], name: 'FCL' },\n    { kind: 'road_lcl', type: 'road', classes: ['bg','s'], name: 'LCL' },\n    { kind: 'road_fcl', type: 'road', classes: ['bg'], name: 'FCL' },\n    { kind: 'road_adr', type: 'road', classes: ['bg'], name: 'ADR' },\n    { kind: 'road_ref', type: 'road', classes: ['bg'], name: 'REF' },\n    { kind: 'sea_teus', type: 'sea', classes: [ 's','e'], name: 'TEUS' },\n    { kind: 'sea_lcl', type: 'sea', classes: ['e'], name: 'LCL' },\n    { kind: 'sea_sp', type: 'sea', classes: ['e'], name: 'СП' },\n    { kind: 'rw_teus', type: 'rail', classes: ['bg', 's'], name: 'TEUS' },\n    { kind: 'rw_lcl', type: 'rail', classes: ['bg'], name: 'LCL' },\n    { kind: 'rw_sp', type: 'rail', classes: ['bg', 'e'], name: 'СП' },\n  ];\n","import { Country } from \"src/app/api/custom_models\";\n\nexport const unknownCountry: Country = {\n  id: 12345678,\n  name: 'Неизвестная страна',\n  name_from: 'Неизвестной страны',\n  name_to: 'Неизвестную страну',\n};"],"names":["takeUntil","tap","BehaviorSubject","Subject","MySettingsService","constructor","apiSettingsService","route","_menuGroups","_tableRows$","_destroy$","getMenuGroups","loadMenuGroups","settingsFilterFormParam","pipe","response","buildMenuGroups","tables","createCommonSettingsGroup","createCompanyStructureGroup","createSystemGroup","createTableFiltersGroup","createDirectoriesGroup","title","cssClass","expanded","items","link","canAdd","addButtonTitle","transformTablesToMenuItems","map","table","pluralId","id","name","loadTableRows","tableName","settingsFilterList","subscribe","rows","undefined","next","getTableRows$","asObservable","updateTableRows","ngOnDestroy","complete","i0","ɵɵinject","i1","SettingsService","i2","ActivatedRoute","factory","ɵfac","providedIn","BaseComponent","destroy$","snackBarWithShortDuration","duration","snackBarWithLongDuration","byField","of","switchMap","Editor","location","systemService","snackBar","router","isNavigateAfterSave","isEditMode","taxSystems","currencies","headPositions","businessKinds","filteredBusinessKinds","interactionKinds","contactSources","filteredContactSources","clientStatuses","filteredClientStatuses","clientKinds","filteredClientKinds","serviceKinds","isFormSubmitted","data","currentTitle","ngOnInit","detectEditMode","getIdParam","load","editTitle","newTitle","goBack","back","loadTaxSystems","systemTaxSystem","sort","loadCurrencies","systemCurrency","current","console","log","loadHeadPositions","systemHeadPosition","positions","loadBusinessKinds","systemBusiness","kinds","loadInteractionKinds","systemInteraction","loadContactSources","systemContactSource","loadClientStatuses","systemCustomerStatus","loadClientKinds","systemCounterparty","loadServiceKinds","systemServices","hasError","controlName","control","form","get","invalid","getError","errors","showMessage","message","open","showMessageAndGoBack","showMessageAndSwitchToEditMode","navigate","replaceUrl","relativeTo","showMessageAndReload","showError","err","error","error_message","hasDescription","error_message_description","showErrorAndGoBack","read","patchForm","nameForHeader","getNameForHeader","notFoundMessage","patchValue","save","valid","body","value","updateData","createData","remove","delete","afterDelete","removedMessage","afterCreate","afterUpdate","create","createdMessage","update","savedMessage","segments","snapshot","url","s","path","Number","paramMap","ɵɵdirectiveInject","Location","SystemService","i3","i4","MatSnackBar","Router","byName","order","a","b","aName","toLocaleLowerCase","bName","result","localeCompare","field","type","aField","bField","transportSubKindTable","kind","classes","unknownCountry","name_from","name_to"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}